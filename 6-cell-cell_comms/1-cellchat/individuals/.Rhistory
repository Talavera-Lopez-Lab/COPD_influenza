setwd("/Users/cartalop/github/COPD_influenza/6-cell-cell_comms/1-cellchat")
### Load required modules
library(NMF)
library(dplyr)
library(igraph)
library(Matrix)
library(ggplot2)
library(CellChat)
library(patchwork)
library(ggalluvial)
library(reticulate)
library(wordcloud)
library(ComplexHeatmap)
options(stringsAsFactors = FALSE)
trace(netClustering, edit=TRUE)
### Load required modules
library(NMF)
library(dplyr)
library(igraph)
library(Matrix)
library(ggplot2)
library(CellChat)
library(patchwork)
library(ggalluvial)
library(reticulate)
library(wordcloud)
library(ComplexHeatmap)
options(stringsAsFactors = FALSE)
#trace(netClustering, edit=TRUE)
use_python("/Users/cartalop/mambaforge/envs/scanpy/bin", required = TRUE)
### Read in data
cellchat.ctrl <- readRDS("../../../data/Mixed_Healthy-CTRL_anotated.rds")
### Load required modules
library(NMF)
library(dplyr)
library(igraph)
library(Matrix)
library(ggplot2)
library(CellChat)
library(patchwork)
library(ggalluvial)
library(reticulate)
library(wordcloud)
library(ComplexHeatmap)
options(stringsAsFactors = FALSE)
#trace(netClustering, edit=TRUE)
use_python("/Users/cartalop/mambaforge/envs/scanpy/bin", required = TRUE)
### Read in data
cellchat.ctrl <- readRDS("../../../data/Mixed_Healthy-CTRL_anotated.rds")
setwd("/Users/cartalop/github/COPD_influenza/6-cell-cell_comms/1-cellchat/individuals")
devtools::install_github("jinworks/CellChat")
# install.packages("devtools")
devtools::install_github("immunogenomics/presto")
devtools::install_github("jinworks/CellChat")
### Load required modules
library(NMF)
library(dplyr)
library(igraph)
library(Matrix)
library(ggplot2)
library(CellChat)
library(patchwork)
library(ggalluvial)
library(reticulate)
options(stringsAsFactors = FALSE)
use_python("/Users/cartalop/mambaforge/envs/scanpy/bin", required = TRUE)
### Read in data
ad <- import("anndata", convert = FALSE)
pd <- import("pandas", convert = FALSE)
ad_object <- ad$read_h5ad("../../data/Healthy-CTRL_anotated.h5ad")
### Load required modules
library(NMF)
library(dplyr)
library(igraph)
library(Matrix)
library(ggplot2)
library(CellChat)
library(patchwork)
library(ggalluvial)
library(reticulate)
options(stringsAsFactors = FALSE)
use_python("/Users/cartalop/mambaforge/envs/scanpy/bin", required = TRUE)
### Read in data
ad <- import("anndata", convert = FALSE)
pd <- import("pandas", convert = FALSE)
ad_object <- ad$read_h5ad("../../../data/Healthy-CTRL_anotated.h5ad")
### Load required modules
library(NMF)
library(dplyr)
library(igraph)
library(Matrix)
library(ggplot2)
library(CellChat)
library(patchwork)
library(ggalluvial)
library(reticulate)
options(stringsAsFactors = FALSE)
use_python("/Users/cartalop/mambaforge/envs/scanpy/bin", required = TRUE)
### Read in data
ad <- import("anndata", convert = FALSE)
pd <- import("pandas", convert = FALSE)
ad_object <- ad$read_h5ad("../../../data/Epithelial_Healthy-CTRL_anotated.h5ad")
### Load required modules
library(NMF)
library(dplyr)
library(igraph)
library(Matrix)
library(ggplot2)
library(CellChat)
library(patchwork)
library(ggalluvial)
library(reticulate)
options(stringsAsFactors = FALSE)
use_python("/Users/cartalop/mambaforge/envs/scanpy/bin", required = TRUE)
### Read in data
ad <- import("anndata", convert = FALSE)
pd <- import("pandas", convert = FALSE)
ad_object <- ad$read_h5ad("../../../data/Epithelial_Healthy-CTRL_anotated.h5ad")
### Access expression matrix
data.input <- t(py_to_r(ad_object$X))
### Add metadata
rownames(data.input) <- rownames(py_to_r(ad_object$var))
colnames(data.input) <- rownames(py_to_r(ad_object$obs))
meta.data <- py_to_r(ad_object$obs)
meta <- meta.data
### Create `cellchat` object
cellchat <- createCellChat(object = data.input, meta = meta, group.by = "cell_states")
### Set up ligand-receptor interaction database for `cellchat`
CellChatDB <- CellChatDB.human
